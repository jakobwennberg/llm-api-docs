# Milestoneservice.Htm

**Source:** https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm  
**Scraped:** 2025-08-01 11:22:36

---

[ ![](https://help.certinia.com/api/resources/images/Logo.png) ](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/Default.htm) Professional Services Automation Apex API Developer Reference |   
---|---  
    * [Home](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/Default.htm)
    * [Getting Started](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [Certinia API](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/GenericAPI.htm)
    * [Actuals](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [APIActualsService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/APIActualsService.htm)
    * [Billing](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [APIBillingService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/APIBillingService.htm)
      * [BillingDocumentService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/BillingDocumentService.htm)
      * [BillingEventsManager](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/BillingEventsManager.htm)
    * [Common](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [APICommonsService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/APICommonsService.htm)
      * [CalendarUtil](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/CalendarUtil.htm)
    * [Exceptions](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [APIException](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/APIException.htm)
    * [Milestones](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [MilestoneService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm)
    * [Miscellaneous](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [MultiCurrencyService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MultiCurrencyService.htm)
    * [Project Versioning and Baselines](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [VersionConfigService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/VersionConfigService.htm)
      * [VersionService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/VersionService.htm)
    * [Projects and Project Tasks](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [AddFromProjectTemplateService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/AddFromProjectTemplateService.htm)
      * [CreateProjectFromTemplateService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/CreateProjectFromTemplateService.htm)
      * [SObjectCloneMapper](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/SObjectCloneMapper.htm)
      * [TaskManagementService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/TaskManagementService.htm)
    * [Rate Cards](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [RateCardMatcherPlugin](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/RateCardMatcherPlugin.htm)
    * [Resource Management](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [ResourceAssignmentService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/ResourceAssignmentService.htm)
      * [ResourceSearchService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/ResourceSearchService.htm)
      * [ScheduleResourceService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/ScheduleResourceService.htm)
    * [Scheduling](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [AssignmentService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/AssignmentService.htm)
      * [HoursToDaysRuleService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/HoursToDaysRuleService.htm)
      * [ScheduleSaveDTO](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/ScheduleSaveDTO.htm)
      * [ScheduleService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/ScheduleService.htm)
      * [SchedulingStrategyService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/SchedulingStrategyService.htm)
    * [Services Forecasting](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [RevenueForecastScheduler](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/RevenueForecastScheduler.htm)
      * [RevenueForecastService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/RevenueForecastService.htm)
      * [RevenueForecastVersionScheduler](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/RevenueForecastVersionScheduler.htm)
      * [RevenueForecastVersionService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/RevenueForecastVersionService.htm)
    * [Shift Management](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [TeamScheduleService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/TeamScheduleService.htm)
      * [TeamScheduleTemplateService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/TeamScheduleTemplateService.htm)
    * [Skills](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [SkillsService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/SkillsService.htm)
    * [Time And Expense](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [PSATimecardService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/PSATimecardService.htm)
    * [Utilization Analytics](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/)
      * [UtilizationAnalyticsService](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/UtilizationAnalyticsService.htm)

|  pse.MilestoneService global with sharing class MilestoneService Service providing functionality relating to Milestones. This class contains [deprecated items](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#deprecated).
## Methods
  * [global static Id updateExpenseRollups(Set<Id> milestoneIds)](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#updateExpenseRollups0)
  * [global static Id updateTimecardRollupsAsync(Set<Id> milestoneIds)](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#updateTimecardRollupsAsync0)
  * [global static Id updateTimecardRollups(Set<Id> milestoneIds)](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#updateTimecardRollups0)
  * [global static Id updateExpenseRollupsAsyncAPI(Set<Id> milestoneIds)](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#updateExpenseRollupsAsyncAPI0)
  * [global static Id updateTimecardRollupsAsyncAPI(Set<Id> milestoneIds)](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#updateTimecardRollupsAsyncAPI0)

updateExpenseRollups _global static Id updateExpenseRollups(Set <Id> milestoneIds)_ Recalculates fields on Milestone whose values are calculated from Expenses linked to the Milestone. This version will execute synchronously, but may fail with large volumes of data. If the calculation needs to handle large numbers of expenses or milestones, call MilestoneService.updateExpenseRollupsAsync(Set<Id> milestoneIds) instead.   
The fields that will be updated are: 
  * pse__Billable_Expenses_In_Financials__c
  * pse__Billable_Expenses_Submitted__c
  * pse__Non_Billable_Expenses_In_Financials__c
  * pse__Non_Billable_Expenses_Submitted__c

Note that PSA's triggers will keep these fields up to date. However it may be necessary to call this method to correct data in some situations, for example when a milestone is closed.
#### Input Parameters
| Name | Type | Description  
---|---|---  
milestoneIds | Set<Id> | The milestones on which to recalculate the expense rollup fields.  
#### Sample Code
```
//Note: This sample code is for demonstration purposes only. It is not intended for
//use in a production environment, is not guaranteed against defects or errors, and
//is in no way optimized or streamlined.

//Recalculate all Expense data on all milestones on the 'Small Project' project. This is known to be a small project with only a few milestones and expenses, so synchronous processing is appropriate.
List<pse__Milestone__c> milestones = [SELECT Id FROM pse__Milestone__c WHERE pse__Project__r.Name = 'Small Project'];
Set<Id> milestonesToRecalculate = new Set<Id>();
for (pse__Milestone__c ms : milestones)
{
    milestonesToRecalculate.add(ms.Id);
}

pse.MilestoneService.updateExpenseRollups(milestonesToRecalculate);

```

updateTimecardRollupsAsync
_global static Id updateTimecardRollupsAsync(Set <Id> milestoneIds)_
Recalculates fields on Milestone whose values are calculated from Timecards linked to the Milestone. This version may run asynchronously to handle large volumes of data. If you want the calculation performed immediately, call MilestoneService.updateTimecardRollups(Set<Id> milestoneIds) instead.   
The fields that will be updated are: 
  * pse__Billable_Amount_In_Financials__c
  * pse__Billable_Amount_Submitted__c
  * pse__Billable_Days_In_Financials__c
  * pse__Billable_Days_Submitted__c
  * pse__Billable_Hours_In_Financials__c
  * pse__Billable_Hours_Submitted__c
  * pse__Non_Billable_Days_In_Financials__c
  * pse__Non_Billable_Days_Submitted__c
  * pse__Non_Billable_Hours_In_Financials__c
  * pse__Non_Billable_Hours_Submitted__c
  * pse__Timecard_External_Costs_In_Financials__c
  * pse__Timecard_External_Costs_Submitted__c
  * pse__Timecard_Internal_Costs_In_Financials__c
  * pse__Timecard_Internal_Costs_Submitted__c

Note that PSA's triggers will keep these fields up to date. However it may be necessary to call this method to correct data in some situations, for example when a milestone is closed.
#### Input Parameters
Name | Type | Description  
---|---|---  
milestoneIds | Set<Id> | The milestones on which to recalculate the timecard rollup fields.  
#### Return Value
The Id of the ApexAsyncJob that performs the calculation. Note this job may create other async jobs. So the rollup process might run for some time after the job in the return value has completed.
#### Sample Code
```
//Note: This sample code is for demonstration purposes only. It is not intended for
//use in a production environment, is not guaranteed against defects or errors, and
//is in no way optimized or streamlined.

//Recalculate all Timecard data on all milestones on the 'Large Project' project. We know this is a large project with lots of milestones and timecards, so asynchronous processing is required.
List<pse_Milestone__c> milestones = [SELECT Id FROM pse_Milestone__c WHERE pse__Project__r.Name = 'Large Project'];
Set<Id> milestonesToRecalculate = new Set<Id>();
for (pse_Milestone__c ms : milestones)
{
    milestonesToRecalculate.add(ms.Id);
}

Id jobId = pse.MilestoneService.updateTimecardRollupsAsync(milestonesToRecalculate);

```

updateTimecardRollups
_global static Id updateTimecardRollups(Set <Id> milestoneIds)_
Recalculates fields on Milestone whose values are calculated from Timecards linked to the Milestone. This version will execute synchronously, but may fail with large volumes of data. If the calculation needs to handle large numbers of timecards or milestones, call MilestoneService.updateTimecardRollupsAsync(Set<Id> milestoneIds) instead.   
The fields that will be updated are: 
  * pse__Billable_Amount_In_Financials__c
  * pse__Billable_Amount_Submitted__c
  * pse__Billable_Days_In_Financials__c
  * pse__Billable_Days_Submitted__c
  * pse__Billable_Hours_In_Financials__c
  * pse__Billable_Hours_Submitted__c
  * pse__Non_Billable_Days_In_Financials__c
  * pse__Non_Billable_Days_Submitted__c
  * pse__Non_Billable_Hours_In_Financials__c
  * pse__Non_Billable_Hours_Submitted__c
  * pse__Timecard_External_Costs_In_Financials__c
  * pse__Timecard_External_Costs_Submitted__c
  * pse__Timecard_Internal_Costs_In_Financials__c
  * pse__Timecard_Internal_Costs_Submitted__c

Note that PSA's triggers will keep these fields up to date. However it may be necessary to call this method to correct data in some situations, for example when a milestone is closed.
#### Input Parameters
Name | Type | Description  
---|---|---  
milestoneIds | Set<Id> | The milestones on which to recalculate the timecard rollup fields.  
#### Sample Code
```
//Note: This sample code is for demonstration purposes only. It is not intended for
//use in a production environment, is not guaranteed against defects or errors, and
//is in no way optimized or streamlined.

//Recalculate all Timecard data on all milestones on the 'Small Project' project. This is known to be a small project with only a few milestones and timecards, so synchronous processing is appropriate.
List<pse__Milestone__c> milestones = [SELECT Id FROM pse__Milestone__c WHERE pse__Project__r.Name = 'Small Project'];
Set<Id> milestonesToRecalculate = new Set<Id>();
for (pse__Milestone__c ms : milestones)
{
    milestonesToRecalculate.add(ms.Id);
}

pse.MilestoneService.updateTimecardRollups(milestonesToRecalculate);

```

updateExpenseRollupsAsyncAPI
_global static Id updateExpenseRollupsAsyncAPI(Set <Id> milestoneIds)_
Recalculates fields on Milestone whose values are calculated from Expenses linked to the Milestone. This version may run asynchronously to handle large volumes of data. If you want the calculation performed immediately, call MilestoneService.updateExpenseRollups(Set<Id> milestoneIds) instead.   
The fields that will be updated are: 
  * pse__Billable_Expenses_In_Financials__c
  * pse__Billable_Expenses_Submitted__c
  * pse__Non_Billable_Expenses_In_Financials__c
  * pse__Non_Billable_Expenses_Submitted__c

Note that PSA's triggers will keep these fields up to date. However it may be necessary to call this method to correct data in some situations, for example when a milestone is closed.
#### Input Parameters
Name | Type | Description  
---|---|---  
milestoneIds | Set<Id> | The milestones on which to recalculate the expense rollup fields.  
#### Return Value
The Id of the AsyncJobRecord that performs the calculation. Note this job may create other async job records. So the rollup process might run for some time after the job in the return value has completed.
#### Sample Code
```
//Note: This sample code is for demonstration purposes only. It is not intended for
//use in a production environment, is not guaranteed against defects or errors, and
//is in no way optimized or streamlined.

You need to provide some sample code

```

updateTimecardRollupsAsyncAPI
_global static Id updateTimecardRollupsAsyncAPI(Set <Id> milestoneIds)_
Recalculates fields on Milestone whose values are calculated from Timecards linked to the milestone. This version may run asynchronously to handle large volumes of data. If you want the calculation performed immediately, call MilestoneService.updateTimecardRollupsEnqueuer(Set<Id> milestoneIds) instead.   
The fields that will be updated are: 
  * pse__Billable_Amount_In_Financials__c
  * pse__Billable_Amount_Submitted__c
  * pse__Billable_Days_In_Financials__c
  * pse__Billable_Days_Submitted__c
  * pse__Billable_Hours_In_Financials__c
  * pse__Billable_Hours_Submitted__c
  * pse__Non_Billable_Days_In_Financials__c
  * pse__Non_Billable_Days_Submitted__c
  * pse__Non_Billable_Hours_In_Financials__c
  * pse__Non_Billable_Hours_Submitted__c
  * pse__Timecard_External_Costs_In_Financials__c
  * pse__Timecard_External_Costs_Submitted__c
  * pse__Timecard_Internal_Costs_In_Financials__c
  * pse__Timecard_Internal_Costs_Submitted__c

Note that PSA's triggers will keep these fields up to date. However it may be necessary to call this method to correct data in some situations, for example when an milestone is closed.
#### Input Parameters
Name | Type | Description  
---|---|---  
milestoneIds | Set<Id> | The milestones on which to recalculate the timecard rollup fields.  
#### Return Value
The Id of the ApexAsyncJob that performs the calculation. Note this job may create other async jobs. So the rollup process might run for some time after the job in the return value has completed.
#### Sample Code
```
//Note: This sample code is for demonstration purposes only. It is not intended for
//use in a production environment, is not guaranteed against defects or errors, and
//is in no way optimized or streamlined.

You need to provide some sample code

```

## Deprecated
The following items are deprecated and not supported for use. We recommend that you stop using these items to avoid exceptions.
### Methods
  * [global static Id updateExpenseRollupsAsync(Set<Id> milestoneIds)](https://help.certinia.com/TechnicalReference/2025.1/ProfessionalServicesAutomation/Apex/MilestoneService.htm#updateExpenseRollupsAsync0)


updateExpenseRollupsAsync
**Deprecated: Use updateExpenseRollupsAsyncAPI(Set assignmentIds) instead.**
_global static Id updateExpenseRollupsAsync(Set <Id> milestoneIds)_
Recalculates fields on Milestone whose values are calculated from Expenses linked to the Milestone. This version may run asynchronously to handle large volumes of data. If you want the calculation performed immediately, call MilestoneService.updateExpenseRollups(Set<Id> milestoneIds) instead.   
The fields that will be updated are: 
  * pse__Billable_Expenses_In_Financials__c
  * pse__Billable_Expenses_Submitted__c
  * pse__Non_Billable_Expenses_In_Financials__c
  * pse__Non_Billable_Expenses_Submitted__c

Note that PSA's triggers will keep these fields up to date. However it may be necessary to call this method to correct data in some situations, for example when a milestone is closed.
#### Input Parameters
Name | Type | Description  
---|---|---  
milestoneIds | Set<Id> | The milestones on which to recalculate the expense rollup fields.  
#### Return Value
The Id of the ApexAsyncJob that performs the calculation. Note this job may create other async jobs. So the rollup process might run for some time after the job in the return value has completed.
#### Sample Code
```
//Note: This sample code is for demonstration purposes only. It is not intended for
//use in a production environment, is not guaranteed against defects or errors, and
//is in no way optimized or streamlined.

//Recalculate all Expense data on all milestones on the 'Large Project' project. We know this is a large project with lots of milestones and expenses, so asynchronous processing is required.
List<pse_Milestone__c> milestones = [SELECT Id FROM pse_Milestone__c WHERE pse__Project__r.Name = 'Large'];
Set<Id> milestonesToRecalculate = new Set<Id>();
for (pse_Milestone__c ms : milestones)
{
    milestonesToRecalculate.add(ms.Id);
}

Id jobId = pse.MilestoneService.updateExpenseRollupsAsync(milestonesToRecalculate);

```

© Copyright 2009–2025 Certinia Inc. All rights reserved. Various trademarks held by their respective owners. 
